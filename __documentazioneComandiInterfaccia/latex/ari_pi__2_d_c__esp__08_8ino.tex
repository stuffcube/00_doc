\hypertarget{ari_pi__2_d_c__esp__08_8ino}{}\section{C\+:/\+Users/giorgio.rancilio/\+Dropbox/\+Makers\+Pgo/progetto\+Alfredo/arianna/ari2\+D\+Cmotor/arianna-\/arianna2dc/00\+\_\+ari\+\_\+\+V3\+\_\+git/\+A\+R\+I\+\_\+\+V3/02\+\_\+fw\+Arianna/ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08/ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.ino File Reference}
\label{ari_pi__2_d_c__esp__08_8ino}\index{C\+:/\+Users/giorgio.\+rancilio/\+Dropbox/\+Makers\+Pgo/progetto\+Alfredo/arianna/ari2\+D\+Cmotor/arianna-\/arianna2dc/00\+\_\+ari\+\_\+\+V3\+\_\+git/\+A\+R\+I\+\_\+\+V3/02\+\_\+fw\+Arianna/ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08/ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{C\+:/\+Users/giorgio.\+rancilio/\+Dropbox/\+Makers\+Pgo/progetto\+Alfredo/arianna/ari2\+D\+Cmotor/arianna-\/arianna2dc/00\+\_\+ari\+\_\+\+V3\+\_\+git/\+A\+R\+I\+\_\+\+V3/02\+\_\+fw\+Arianna/ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08/ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
{\ttfamily \#include $<$S\+P\+I.\+h$>$}\newline
{\ttfamily \#include $<$S\+D.\+h$>$}\newline
{\ttfamily \#include $<$Servo.\+h$>$}\newline
{\ttfamily \#include $<$T\+F\+Mini.\+h$>$}\newline
{\ttfamily \#include $<$E\+E\+P\+R\+O\+M.\+h$>$}\newline
{\ttfamily \#include $<$Wire.\+h$>$}\newline
{\ttfamily \#include $<$Adafruit\+\_\+\+Sensor.\+h$>$}\newline
{\ttfamily \#include $<$Adafruit\+\_\+\+L\+S\+M303\+\_\+\+U.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$D\+R\+V8833.\+h$>$}\newline
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ac4e2d6235f12dec9dc3674a0e0a139ba}\label{ari_pi__2_d_c__esp__08_8ino_ac4e2d6235f12dec9dc3674a0e0a139ba}} 
\#define {\bfseries V\+\_\+\+F\+W\+\_\+\+A\+T\+M\+E\+GA}~\char`\"{}3.\+04.\+00\char`\"{}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_af5e2c0a692b6b075e9a95ac11a5c5b06}\label{ari_pi__2_d_c__esp__08_8ino_af5e2c0a692b6b075e9a95ac11a5c5b06}} 
\#define {\bfseries A\+R\+I3}~1
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a0795d970ec6b0998fc398ecba0dc1fbc}\label{ari_pi__2_d_c__esp__08_8ino_a0795d970ec6b0998fc398ecba0dc1fbc}} 
\#define {\bfseries S\+C\+R\+I\+VI}~0
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a6f99aa69652bb4f0435fbf31d21ba7c9}\label{ari_pi__2_d_c__esp__08_8ino_a6f99aa69652bb4f0435fbf31d21ba7c9}} 
\#define {\bfseries L\+E\+G\+GI}~1
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a3da44afeba217135a680a7477b5e3ce3}\label{ari_pi__2_d_c__esp__08_8ino_a3da44afeba217135a680a7477b5e3ce3}} 
\#define {\bfseries D\+E\+F\+A\+U\+LT}~2
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a8e296a962daed7fa0ffeeab350593594}\label{ari_pi__2_d_c__esp__08_8ino_a8e296a962daed7fa0ffeeab350593594}} 
\#define {\bfseries D\+U\+E\+\_\+\+PI}~6.\+28318
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a3059d914dc801da27fea64290d8f0a28}\label{ari_pi__2_d_c__esp__08_8ino_a3059d914dc801da27fea64290d8f0a28}} 
\#define {\bfseries E\+S\+Pserial}~Serial2
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a09582c1cafb46dfb44288122f23ed702}\label{ari_pi__2_d_c__esp__08_8ino_a09582c1cafb46dfb44288122f23ed702}} 
\#define {\bfseries T\+Fserial}~Serial1
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_acc60ca04f3ee450b48548582048ed8fa}\label{ari_pi__2_d_c__esp__08_8ino_acc60ca04f3ee450b48548582048ed8fa}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_acc60ca04f3ee450b48548582048ed8fa}{S\+E\+R\+V\+O\+\_\+\+P\+A\+N\+\_\+\+P\+IN}}~45
\begin{DoxyCompactList}\small\item\em Digital IO pin connected to the servo pin. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_aacf6d5e66edfb457b13cbced950fc0af}\label{ari_pi__2_d_c__esp__08_8ino_aacf6d5e66edfb457b13cbced950fc0af}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_aacf6d5e66edfb457b13cbced950fc0af}{S\+E\+R\+V\+O\+\_\+\+T\+I\+L\+T\+\_\+\+P\+IN}}~44
\begin{DoxyCompactList}\small\item\em Digital IO pin connected to the servo pin. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a594090dbf515f41d4249fade4f14c463}\label{ari_pi__2_d_c__esp__08_8ino_a594090dbf515f41d4249fade4f14c463}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a594090dbf515f41d4249fade4f14c463}{G\+I\+R\+O\+\_\+\+D\+X\+\_\+\+P\+IN}}~3
\begin{DoxyCompactList}\small\item\em encoder rotazione albero motore I\+D\+\_\+009 \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ab1940449ba61cdf83d35a9dab25b039c}\label{ari_pi__2_d_c__esp__08_8ino_ab1940449ba61cdf83d35a9dab25b039c}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_ab1940449ba61cdf83d35a9dab25b039c}{G\+I\+R\+O\+\_\+\+S\+X\+\_\+\+P\+IN}}~2
\begin{DoxyCompactList}\small\item\em encoder rotazione albero motore I\+D\+\_\+009 \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a3b5d438b9c0508db7c53e86daa265dc8}\label{ari_pi__2_d_c__esp__08_8ino_a3b5d438b9c0508db7c53e86daa265dc8}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a3b5d438b9c0508db7c53e86daa265dc8}{R\+\_\+\+S\+I\+D\+E\+\_\+\+F\+R\+O\+NT}}~29
\begin{DoxyCompactList}\small\item\em sensore frontale Dx Low = ostacolo \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a531e2edff1884d356024e8764761ffaa}\label{ari_pi__2_d_c__esp__08_8ino_a531e2edff1884d356024e8764761ffaa}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a531e2edff1884d356024e8764761ffaa}{L\+\_\+\+S\+I\+D\+E\+\_\+\+F\+R\+O\+NT}}~31
\begin{DoxyCompactList}\small\item\em sensore frontale Sx \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a551793442f7ac915171c5478f3df0955}\label{ari_pi__2_d_c__esp__08_8ino_a551793442f7ac915171c5478f3df0955}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a551793442f7ac915171c5478f3df0955}{E\+N\+B\+\_\+\+R\+\_\+\+S\+I\+D\+E\+\_\+\+F\+R\+O\+NT}}~28
\begin{DoxyCompactList}\small\item\em abilita sensore frontale Dx. High = Enable \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a5709a7b011efe9859445cf4a2c0646ea}\label{ari_pi__2_d_c__esp__08_8ino_a5709a7b011efe9859445cf4a2c0646ea}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a5709a7b011efe9859445cf4a2c0646ea}{E\+N\+B\+\_\+\+L\+\_\+\+S\+I\+D\+E\+\_\+\+F\+R\+O\+NT}}~30
\begin{DoxyCompactList}\small\item\em abilita frontale Sx \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a8aa85ae9867fabf70ec72cd3bf6fb6b9}\label{ari_pi__2_d_c__esp__08_8ino_a8aa85ae9867fabf70ec72cd3bf6fb6b9}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a8aa85ae9867fabf70ec72cd3bf6fb6b9}{L\+E\+D1}}~34
\begin{DoxyCompactList}\small\item\em L\+E\+D1. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ad09fe5bf321b9a2de26bd5e5b9af6424}\label{ari_pi__2_d_c__esp__08_8ino_ad09fe5bf321b9a2de26bd5e5b9af6424}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_ad09fe5bf321b9a2de26bd5e5b9af6424}{L\+E\+D2}}~33
\begin{DoxyCompactList}\small\item\em L\+E\+D2. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a4b7ff8e253a7412f83deba3a447028a8}\label{ari_pi__2_d_c__esp__08_8ino_a4b7ff8e253a7412f83deba3a447028a8}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a4b7ff8e253a7412f83deba3a447028a8}{L\+E\+D3}}~32
\begin{DoxyCompactList}\small\item\em L\+E\+D3. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a49ba715e713d99d1a5c20429dacaf073}\label{ari_pi__2_d_c__esp__08_8ino_a49ba715e713d99d1a5c20429dacaf073}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a49ba715e713d99d1a5c20429dacaf073}{led\+Pin}}~13
\begin{DoxyCompactList}\small\item\em led segnalazioni varie su Arduino \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ad29f66110456ba86205034ad1232fca8}\label{ari_pi__2_d_c__esp__08_8ino_ad29f66110456ba86205034ad1232fca8}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_ad29f66110456ba86205034ad1232fca8}{laser\+Pin}}~8
\begin{DoxyCompactList}\small\item\em porta puntatore laser \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a61f762ee849a4b411a7cc07d78dde55d}\label{ari_pi__2_d_c__esp__08_8ino_a61f762ee849a4b411a7cc07d78dde55d}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a61f762ee849a4b411a7cc07d78dde55d}{T\+E\+S\+T\+\_\+\+M\+O\+T\+O\+RE}}~0
\begin{DoxyCompactList}\small\item\em modalità di test per fasi di debug \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a3e6a2d7b0da74a50b9fd5b16aace4414}\label{ari_pi__2_d_c__esp__08_8ino_a3e6a2d7b0da74a50b9fd5b16aace4414}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a3e6a2d7b0da74a50b9fd5b16aace4414}{T\+E\+S\+T\+\_\+\+S\+T\+E\+R\+ZO}}~1
\begin{DoxyCompactList}\small\item\em modalità di test per fasi di debug \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_addf0ed25cb1de6ac65f3f60a7f50c01a}\label{ari_pi__2_d_c__esp__08_8ino_addf0ed25cb1de6ac65f3f60a7f50c01a}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_addf0ed25cb1de6ac65f3f60a7f50c01a}{T\+E\+S\+T\+\_\+\+S\+E\+N\+S\+O\+RS}}~2
\begin{DoxyCompactList}\small\item\em modalità di test per fasi di debug \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ab57f62e8f32f367dbca255771ff72e20}\label{ari_pi__2_d_c__esp__08_8ino_ab57f62e8f32f367dbca255771ff72e20}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_ab57f62e8f32f367dbca255771ff72e20}{T\+E\+S\+T\+\_\+\+C\+O\+N\+T\+R\+O\+L\+LO}}~3
\begin{DoxyCompactList}\small\item\em modalità di test per fasi di debug \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_adcc6c25175a8908813ff718bc774c2ab}\label{ari_pi__2_d_c__esp__08_8ino_adcc6c25175a8908813ff718bc774c2ab}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_adcc6c25175a8908813ff718bc774c2ab}{T\+E\+S\+T\+\_\+\+G\+I\+R\+O\+\_\+\+S\+E\+N\+S\+OR}}~4
\begin{DoxyCompactList}\small\item\em modalità di test per fasi di debug \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ab6c0fc0e0028f3917b0ce67bee73d01e}\label{ari_pi__2_d_c__esp__08_8ino_ab6c0fc0e0028f3917b0ce67bee73d01e}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_ab6c0fc0e0028f3917b0ce67bee73d01e}{T\+E\+M\+P\+O\+\_\+\+C\+O\+N\+T\+R\+O\+L\+LO}}~25
\begin{DoxyCompactList}\small\item\em tempo del controllo sterzo, posizione etc in ms \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a140e19c4b6cb883d0f3abceea67a62ba}\label{ari_pi__2_d_c__esp__08_8ino_a140e19c4b6cb883d0f3abceea67a62ba}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a140e19c4b6cb883d0f3abceea67a62ba}{E\+\_\+\+P\+O\+S\+I\+Z\+I\+O\+N\+A\+M\+E\+N\+TO}}~10
\begin{DoxyCompactList}\small\item\em \mbox{[}mm\mbox{]}, distanza dall\textquotesingle{}obbiettivo dove il robot si arresta \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a60736df151b230ad9683a2e8dbee13a6}\label{ari_pi__2_d_c__esp__08_8ino_a60736df151b230ad9683a2e8dbee13a6}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a60736df151b230ad9683a2e8dbee13a6}{E\+\_\+\+A\+P\+P\+R\+O\+C\+C\+IO}}~300
\begin{DoxyCompactList}\small\item\em \mbox{[}mm\mbox{]}, distanza dall\textquotesingle{}obbiettivo dove il robot inizia a rallentare \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a3ea4f86fda9125c7b34d735b4f14f42a}\label{ari_pi__2_d_c__esp__08_8ino_a3ea4f86fda9125c7b34d735b4f14f42a}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a3ea4f86fda9125c7b34d735b4f14f42a}{F\+E\+R\+MO}}~0
\begin{DoxyCompactList}\small\item\em valore pwm di uscita durante stato di F\+E\+R\+MO \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a4774b749cfc65db93b2e726543c9115f}\label{ari_pi__2_d_c__esp__08_8ino_a4774b749cfc65db93b2e726543c9115f}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a4774b749cfc65db93b2e726543c9115f}{M\+O\+D\+E\+R\+A\+TA}}~190
\begin{DoxyCompactList}\small\item\em valore pwm di uscita durante marcia M\+O\+D\+E\+R\+A\+TA \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a3336677c5466ffd6adee69e68e25f236}\label{ari_pi__2_d_c__esp__08_8ino_a3336677c5466ffd6adee69e68e25f236}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a3336677c5466ffd6adee69e68e25f236}{A\+P\+P\+R\+O\+C\+C\+IO}}~110
\begin{DoxyCompactList}\small\item\em valore pwm di uscita durante marcia A\+P\+P\+R\+O\+C\+C\+IO \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a9af1e62ce938e1b51a846fc15cf307e3}\label{ari_pi__2_d_c__esp__08_8ino_a9af1e62ce938e1b51a846fc15cf307e3}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a9af1e62ce938e1b51a846fc15cf307e3}{A\+C\+C\+E\+L\+E\+R\+A\+Z\+I\+O\+NE}}~160
\begin{DoxyCompactList}\small\item\em valore pwm di uscita durante fase accelerazione (non usato) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a7d6e95bc7ca024893f2bd7d217b2bd6d}\label{ari_pi__2_d_c__esp__08_8ino_a7d6e95bc7ca024893f2bd7d217b2bd6d}} 
\#define {\bfseries A\+V\+A\+N\+TI}~0
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a8db0e8841207a8e9ce1845ba10b4a637}\label{ari_pi__2_d_c__esp__08_8ino_a8db0e8841207a8e9ce1845ba10b4a637}} 
\#define {\bfseries I\+N\+D\+I\+E\+T\+RO}~1
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a6ae4300a3f1fbbb8e3d4393603b6d402}\label{ari_pi__2_d_c__esp__08_8ino_a6ae4300a3f1fbbb8e3d4393603b6d402}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a6ae4300a3f1fbbb8e3d4393603b6d402}{K\+P\+\_\+\+T\+E\+T\+A\+\_\+\+D\+EF}}~0.\+8
\begin{DoxyCompactList}\small\item\em valore default P contrllo guida con distanza muro \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ae69228439056c7947d8c67f0e31cd555}\label{ari_pi__2_d_c__esp__08_8ino_ae69228439056c7947d8c67f0e31cd555}} 
\#define \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_ae69228439056c7947d8c67f0e31cd555}{M\+A\+X\+\_\+\+S\+T\+E\+R\+ZO}}~1.\+0
\begin{DoxyCompactList}\small\item\em massimo valore di sterzo. con 1 si ha una ruota ferma e l\textquotesingle{}altra al doppio della velocita\textquotesingle{} \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a4fc01d736fe50cf5b977f755b675f11d}\label{ari_pi__2_d_c__esp__08_8ino_a4fc01d736fe50cf5b977f755b675f11d}} 
void \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a4fc01d736fe50cf5b977f755b675f11d}{setup}} ()
\begin{DoxyCompactList}\small\item\em setup della parte hardware e caricamento coefficienti da E2prom \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_afe461d27b9c48d5921c00d521181f12f}{loop}} ()
\item 
void \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a6af06b46b74b5a44e1adc270e1e07e6b}{odometro\+Dx\+Misura\+HW}} (void)
\begin{DoxyCompactList}\small\item\em odometri \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_aef8d9e68883244c4d12fb9dfb14b0b2e}\label{ari_pi__2_d_c__esp__08_8ino_aef8d9e68883244c4d12fb9dfb14b0b2e}} 
void \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_aef8d9e68883244c4d12fb9dfb14b0b2e}{odometro\+Sx\+Misura\+HW}} (void)
\begin{DoxyCompactList}\small\item\em vedi Sx \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_af117273d2066fa1917036ae9a9742ae7}{differenziale}} (float motor\+Speed)
\begin{DoxyCompactList}\small\item\em sterzo con differenziale. Per curvare la velocità relativa delle due ruote viene modificata. Con le velocità uguali proseguo diritto, con una maggiore dell\textquotesingle{}altra curvo. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a1961cf99cc4edb6f9f48ea4b3ec3112c}\label{ari_pi__2_d_c__esp__08_8ino_a1961cf99cc4edb6f9f48ea4b3ec3112c}} 
void {\bfseries update\+Position} (void)
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a914ee45b85c8745eaee35cdef279a276}\label{ari_pi__2_d_c__esp__08_8ino_a914ee45b85c8745eaee35cdef279a276}} 
void {\bfseries send\+Answer2} (char port)
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a9d7193cecd4d57fda8e39dc98a236253}\label{ari_pi__2_d_c__esp__08_8ino_a9d7193cecd4d57fda8e39dc98a236253}} 
void {\bfseries richieste} (void)
\item 
void \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a8865513d32ebc241dbe80e5bf49ff775}{comandi}} ()
\begin{DoxyCompactList}\small\item\em comandi\+: i comandi assegnano valori o eseguono funzioni. iniziano con un 3 e hanno la lettera maiuscola, sono seguiti da uno o più numeri. non ci sono spazi di separazione. i numeri, se non diversamente indicato, sono floating point, la virgola è data col \textquotesingle{}.\textquotesingle{}, es 3.\+14 \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a64ea2b252b5ab59be204f70e2206ce1c}{get\+Cmd2}} (void)
\begin{DoxyCompactList}\small\item\em quando arriva una stringa da E\+SP la processa. Il protocollo usato è in A\+S\+C\+II permette di inviare comandi o richieste. ~\newline
 Il primo carattere indica se richiesta (1) o comando (3). \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_ae29b9282fc7ede860a2bb8984ad0560c}{r\+Seriale}} (void)
\begin{DoxyCompactList}\small\item\em riceve i caratteri dalla seriale dell\textquotesingle{}E\+SP. Il char \textquotesingle{}!\textquotesingle{} è l\textquotesingle{}inizio stringa, il \textquotesingle{}?\textquotesingle{} è il terminatore della stringa. il terminatore della stringa è ? \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a24f4d37ce4673eadaa4043cf6ecaff27}{Data\+E\+Eprom}} (char comando)
\begin{DoxyCompactList}\small\item\em gestisce dei valori sulle E2prom. I vengono letti e scritti nello stesso ordine. La procedura gestisce anche il valore di default. letti i valori si procede ad aggiornare i parametri dipendenti dai valori assegnati. Questa procedura viene chiamata al termine dell\textquotesingle{} start\+Up con comando L\+E\+G\+GI. Vengono quindi attivati i parametri salvati in E\+Eprom. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_abbdedc0823a18fd32dee96e0acad447e}\label{ari_pi__2_d_c__esp__08_8ino_abbdedc0823a18fd32dee96e0acad447e}} 
void {\bfseries print\+Dati\+Calibrazione} (void)
\item 
void \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a6f20cd3646bc1f8af9a4f9d5e45f5c90}{test\+Ostacoli}} ()
\begin{DoxyCompactList}\small\item\em riporta al controller la distanza letta dal lidar, la risposta ha formato \char`\"{}mis;\char`\"{} + distanza in cm\char`\"{}.
aggiorna anche la il valore \char`\"{}lidardist" ogni 250 ms. \end{DoxyCompactList}\item 
String \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a23abf4b5bc87f963b0270c015e379872}{lidar}} ()
\begin{DoxyCompactList}\small\item\em libreria lettura lidar \end{DoxyCompactList}\item 
String \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a0f6c65484953fd460fd89ee3a1a3825e}{lidar\+Misura\+Amb}} (int numero\+Misure, int ang)
\begin{DoxyCompactList}\small\item\em legge il lidar e prepara la stringa di risposta. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ac3a1af41d00b96587bf75bad54078a1f}\label{ari_pi__2_d_c__esp__08_8ino_ac3a1af41d00b96587bf75bad54078a1f}} 
void {\bfseries display\+Sensor\+Details} (void)
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a5b51c469eb312609df7a037c33bde58d}\label{ari_pi__2_d_c__esp__08_8ino_a5b51c469eb312609df7a037c33bde58d}} 
void {\bfseries get\+Sensor\+Reading} (void)
\item 
void \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_ada2502f03f6e1fe62fef80b03f317b98}{compass}} (void)
\begin{DoxyCompactList}\small\item\em Gets the most recent sensor values and transform in angle. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a8358c2402fb15c1b0f5fbbfb0a1e6a85}\label{ari_pi__2_d_c__esp__08_8ino_a8358c2402fb15c1b0f5fbbfb0a1e6a85}} 
Adafruit\+\_\+\+L\+S\+M303\+\_\+\+Mag\+\_\+\+Unified {\bfseries mag} = Adafruit\+\_\+\+L\+S\+M303\+\_\+\+Mag\+\_\+\+Unified(12345)
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_aaf3c8c8d2e46ac81d19dda9e4213d6a1}\label{ari_pi__2_d_c__esp__08_8ino_aaf3c8c8d2e46ac81d19dda9e4213d6a1}} 
Servo {\bfseries servo\+Pan}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a1a47b66f30649678ffd87493fe397afd}\label{ari_pi__2_d_c__esp__08_8ino_a1a47b66f30649678ffd87493fe397afd}} 
Servo {\bfseries servo\+Tilt}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_aa556a72ca05ce9a3861b99c901bc58d6}\label{ari_pi__2_d_c__esp__08_8ino_aa556a72ca05ce9a3861b99c901bc58d6}} 
T\+F\+Mini {\bfseries tfmini}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_abfa7bc4032f1ef9070aa48a183f30d4a}\label{ari_pi__2_d_c__esp__08_8ino_abfa7bc4032f1ef9070aa48a183f30d4a}} 
String {\bfseries input\+String} = \char`\"{}\char`\"{}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a54b4b16653970eab34e2ba40199fd6f3}\label{ari_pi__2_d_c__esp__08_8ino_a54b4b16653970eab34e2ba40199fd6f3}} 
String {\bfseries input\+String\+Tmp} = \char`\"{}\char`\"{}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a0f792197854bfeff54c46ebf012b2187}\label{ari_pi__2_d_c__esp__08_8ino_a0f792197854bfeff54c46ebf012b2187}} 
int {\bfseries okcomm} = 0
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a4b20c17190582b367bfba9b9bd5ea962}\label{ari_pi__2_d_c__esp__08_8ino_a4b20c17190582b367bfba9b9bd5ea962}} 
char {\bfseries port} = 0
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ac547551c409b3659bcfa04a597e8d76b}\label{ari_pi__2_d_c__esp__08_8ino_ac547551c409b3659bcfa04a597e8d76b}} 
D\+R\+V8833 {\bfseries driver} = D\+R\+V8833()
\item 
const int \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_ab8a00bd06cb46156aa7cb936b4eb8c85}{M\+T\+R\+\_\+\+A\+\_\+\+D\+X\+\_\+\+P1}} = 5
\item 
const int \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a1daadb07ea3186bedb91de1bbfb47b58}{M\+T\+R\+\_\+\+A\+\_\+\+D\+X\+\_\+\+P2}} = 6
\item 
const int \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a8b68fd0f29306f0feb3d5f3ac5c5c9b4}{M\+T\+R\+\_\+\+B\+\_\+\+S\+X\+\_\+\+P1}} = 9
\item 
const int \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a77c90f26573c080620f9baca24364ebe}{M\+T\+R\+\_\+\+B\+\_\+\+S\+X\+\_\+\+P2}} = 10
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ac179a794839296fb9b090264967b2dd9}\label{ari_pi__2_d_c__esp__08_8ino_ac179a794839296fb9b090264967b2dd9}} 
int {\bfseries motor\+Speed\+Ref} = 0
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a6505c8e9ac66c5a6ac679bc41647f100}\label{ari_pi__2_d_c__esp__08_8ino_a6505c8e9ac66c5a6ac679bc41647f100}} 
int {\bfseries direzione} = 1
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a6e9c7be6c7c4f653f9d3ca70006130e6}\label{ari_pi__2_d_c__esp__08_8ino_a6e9c7be6c7c4f653f9d3ca70006130e6}} 
int {\bfseries dir\+VA} = 1
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_aaf30ecc1398dffba96805a9ce60d1480}\label{ari_pi__2_d_c__esp__08_8ino_aaf30ecc1398dffba96805a9ce60d1480}} 
int {\bfseries dir\+VB} = 1
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_aa57b545b28e726dc370d6afd59930221}\label{ari_pi__2_d_c__esp__08_8ino_aa57b545b28e726dc370d6afd59930221}} 
int {\bfseries V\+B\+\_\+zero} = 0
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a57bf2119e3e83782219233e9bd8b0125}\label{ari_pi__2_d_c__esp__08_8ino_a57bf2119e3e83782219233e9bd8b0125}} 
int {\bfseries V\+A\+\_\+zero} = 0
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a4e6edab3c135f74217f544821dbb3a49}\label{ari_pi__2_d_c__esp__08_8ino_a4e6edab3c135f74217f544821dbb3a49}} 
long {\bfseries odometro\+Cnt}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a0ac82b55ed4fe13596eeffa61bb06685}\label{ari_pi__2_d_c__esp__08_8ino_a0ac82b55ed4fe13596eeffa61bb06685}} 
long {\bfseries odometro\+Dx\+Cnt}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ab4ce4d95d7983a12a924f49196f9b9a5}\label{ari_pi__2_d_c__esp__08_8ino_ab4ce4d95d7983a12a924f49196f9b9a5}} 
long \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_ab4ce4d95d7983a12a924f49196f9b9a5}{odometro\+Sx\+Cnt}}
\begin{DoxyCompactList}\small\item\em contatori encoder \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a7acc771f00b743e5b3e0d2512eb5329b}\label{ari_pi__2_d_c__esp__08_8ino_a7acc771f00b743e5b3e0d2512eb5329b}} 
char {\bfseries first\+Run}
\item 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a46145722dc21eed1a702b867ced59e49}{ED}} = 1.\+0
\item 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_aab9585a72373b934a8e78ac806c57f50}{E\+D\+\_\+\+B\+A\+SE}} = 1.\+0
\item 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a9c5bc38bd76775bbcb1e430646060ca5}{B\+A\+S\+E\+L\+I\+NE}} = 130.\+0
\item 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a023cb7e635b51ac94b3e22f2b6ac8f9c}{L\+A\+G\+H\+E\+Z\+Z\+A\+\_\+\+A\+\_\+\+M\+E\+Z\+ZI}} = 0.\+065
\item 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_aeee767366b9e5e9bb8022b27fcbb7e68}{G\+I\+R\+O\+\_\+\+R\+U\+O\+T\+A\+\_\+\+SX}} = 1.\+0
\item 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a87caded4c49d6deea703487e7f11d9e3}{G\+I\+R\+O\+\_\+\+R\+U\+O\+T\+A\+\_\+\+DX}} = 1.\+0
\item 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_ac57aebfcef0c4d31360b170366395c4a}{G\+I\+R\+O\+\_\+\+R\+U\+O\+TA}} = 1.\+0
\item 
unsigned long \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a6a8d27409d947dce17cce28a56701a5c}{M\+I\+N\+\_\+\+T\+I\+M\+E\+\_\+\+T\+R\+A\+\_\+\+P\+U\+L\+SE}} = 9
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a5339db6126d080787f8511e2aae71e34}\label{ari_pi__2_d_c__esp__08_8ino_a5339db6126d080787f8511e2aae71e34}} 
int \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a5339db6126d080787f8511e2aae71e34}{stato\+Run}} = 0
\begin{DoxyCompactList}\small\item\em macchina a stati del movimento. Definisce anche il tipo controllo guida. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ac36ade784c05554d24241a2fa860bbaa}\label{ari_pi__2_d_c__esp__08_8ino_ac36ade784c05554d24241a2fa860bbaa}} 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_ac36ade784c05554d24241a2fa860bbaa}{odometro}} = 0
\begin{DoxyCompactList}\small\item\em distanza percorsa in mm \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_aa0ded4438d2bf98ac92bf5e3680d5084}\label{ari_pi__2_d_c__esp__08_8ino_aa0ded4438d2bf98ac92bf5e3680d5084}} 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_aa0ded4438d2bf98ac92bf5e3680d5084}{distanza}} = 0
\begin{DoxyCompactList}\small\item\em distanza da percorrere col prossio Run \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a6bd7fe73202cbe57f50f29e17bf7f1d2}\label{ari_pi__2_d_c__esp__08_8ino_a6bd7fe73202cbe57f50f29e17bf7f1d2}} 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a6bd7fe73202cbe57f50f29e17bf7f1d2}{raggior\+Sterzo}} = 0.\+0
\begin{DoxyCompactList}\small\item\em raggior\+Sterzo indica lo scorrimento che applichiamo alle ruote. vedi function differenziale \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a439debc276431dbf94c5d68081e6d38c}\label{ari_pi__2_d_c__esp__08_8ino_a439debc276431dbf94c5d68081e6d38c}} 
int \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a439debc276431dbf94c5d68081e6d38c}{lidardist}} = 0
\begin{DoxyCompactList}\small\item\em \mbox{[}cm\mbox{]} distanza misurata dal Lidar \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a249abd6fb895eba5af34eb2516a7dea3}\label{ari_pi__2_d_c__esp__08_8ino_a249abd6fb895eba5af34eb2516a7dea3}} 
float {\bfseries errore}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a8dfd382ee3674a1db48ad2c69bcaaf56}\label{ari_pi__2_d_c__esp__08_8ino_a8dfd382ee3674a1db48ad2c69bcaaf56}} 
int {\bfseries motor\+Speed} = 0
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a6c202cc2e1ecd2889d313233e5360ae9}\label{ari_pi__2_d_c__esp__08_8ino_a6c202cc2e1ecd2889d313233e5360ae9}} 
int {\bfseries motor\+Speed\+Value} = \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a4774b749cfc65db93b2e726543c9115f}{M\+O\+D\+E\+R\+A\+TA}}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a41052b199a87567ee2438e605f1f949d}\label{ari_pi__2_d_c__esp__08_8ino_a41052b199a87567ee2438e605f1f949d}} 
int \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a41052b199a87567ee2438e605f1f949d}{pan\+Angle}} = 90
\begin{DoxyCompactList}\small\item\em angolo destinazione del servo Pan \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ad64f6da25c8c1de30ddeb9e0541fa839}\label{ari_pi__2_d_c__esp__08_8ino_ad64f6da25c8c1de30ddeb9e0541fa839}} 
int \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_ad64f6da25c8c1de30ddeb9e0541fa839}{tilt\+Angle}} = 90
\begin{DoxyCompactList}\small\item\em angolo destinazione del servo Tilt \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_aa9eb73e0d7151ab1d50ab7d71114e6bd}\label{ari_pi__2_d_c__esp__08_8ino_aa9eb73e0d7151ab1d50ab7d71114e6bd}} 
char \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_aa9eb73e0d7151ab1d50ab7d71114e6bd}{laser}} = 0
\begin{DoxyCompactList}\small\item\em stato uscita puntatore laser \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ad22e5548abfe8e56154370047cf514f1}\label{ari_pi__2_d_c__esp__08_8ino_ad22e5548abfe8e56154370047cf514f1}} 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_ad22e5548abfe8e56154370047cf514f1}{kp\+\_\+guida}} = \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a6ae4300a3f1fbbb8e3d4393603b6d402}{K\+P\+\_\+\+T\+E\+T\+A\+\_\+\+D\+EF}}
\begin{DoxyCompactList}\small\item\em guadagno proporzionale per controllo su distanza muro \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_aadac70a6d3f31635e120f1abbf02afb8}\label{ari_pi__2_d_c__esp__08_8ino_aadac70a6d3f31635e120f1abbf02afb8}} 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_aadac70a6d3f31635e120f1abbf02afb8}{kd\+\_\+guida}} = 10
\begin{DoxyCompactList}\small\item\em guadagno derivativo per controllo su distanza muro \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a6f825712ede5cd29e0ee8a3b8603fa5f}\label{ari_pi__2_d_c__esp__08_8ino_a6f825712ede5cd29e0ee8a3b8603fa5f}} 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a6f825712ede5cd29e0ee8a3b8603fa5f}{kp\+Teta}} = 2.\+0
\begin{DoxyCompactList}\small\item\em guadagno proporzionale per controllo su teta \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ad59a70cc86150e574e73066bf9b92062}\label{ari_pi__2_d_c__esp__08_8ino_ad59a70cc86150e574e73066bf9b92062}} 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_ad59a70cc86150e574e73066bf9b92062}{ki\+Teta}} = 0.\+02
\begin{DoxyCompactList}\small\item\em guadagno integrale per controllo su teta \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a33a1abc735507147bab601374a138b09}\label{ari_pi__2_d_c__esp__08_8ino_a33a1abc735507147bab601374a138b09}} 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a33a1abc735507147bab601374a138b09}{M\+A\+X\+\_\+S}} = 0.\+2
\begin{DoxyCompactList}\small\item\em max\+\_\+s = L\+A\+R\+G\+H\+E\+Z\+Z\+A\+\_\+\+A\+\_\+\+M\+E\+Z\+Z\+I/\+Raggio massimo \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_aa1cebdc383b21b594c09df4f1d035286}\label{ari_pi__2_d_c__esp__08_8ino_aa1cebdc383b21b594c09df4f1d035286}} 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_aa1cebdc383b21b594c09df4f1d035286}{teta}} = 0.\+0
\begin{DoxyCompactList}\small\item\em teta attuale misurato da odometria \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_adad239fcacf5c59997872bd0c12bdfd1}\label{ari_pi__2_d_c__esp__08_8ino_adad239fcacf5c59997872bd0c12bdfd1}} 
float {\bfseries xpos}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_adb369a2ec52b1f831cf362b570df40d2}\label{ari_pi__2_d_c__esp__08_8ino_adb369a2ec52b1f831cf362b570df40d2}} 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_adb369a2ec52b1f831cf362b570df40d2}{ypos}} = 0.\+0
\begin{DoxyCompactList}\small\item\em x attuale misurato da odometria \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a75a4104f4a9f0fc17b53a88379ed7130}\label{ari_pi__2_d_c__esp__08_8ino_a75a4104f4a9f0fc17b53a88379ed7130}} 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a75a4104f4a9f0fc17b53a88379ed7130}{teta\+Ref}} = 0.\+0
\begin{DoxyCompactList}\small\item\em y attuale misurato da odometria \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a31ffabe41a3c406008dc3c8660baa084}\label{ari_pi__2_d_c__esp__08_8ino_a31ffabe41a3c406008dc3c8660baa084}} 
int \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a31ffabe41a3c406008dc3c8660baa084}{dist\+Ref}} = 60
\begin{DoxyCompactList}\small\item\em distanza riferimento per modo R1/\+R2 \mbox{[}cm\mbox{]} \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_abe38243dd59764cbd8a4029c2683a702}\label{ari_pi__2_d_c__esp__08_8ino_abe38243dd59764cbd8a4029c2683a702}} 
int \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_abe38243dd59764cbd8a4029c2683a702}{dist\+Ostacolo}} = 51
\begin{DoxyCompactList}\small\item\em distanza dell\textquotesingle{}Ostacolo per arresto automatico \mbox{[}cm\mbox{]}. N.\+B. sotto i 50 cm a volte non legge. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ae26b39d3cd60fb721672915cdb90d756}\label{ari_pi__2_d_c__esp__08_8ino_ae26b39d3cd60fb721672915cdb90d756}} 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_ae26b39d3cd60fb721672915cdb90d756}{teta\+Misura}} = 0.\+0
\begin{DoxyCompactList}\small\item\em teta da bussola \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a8c4da7cbc4b1a3cc91ebb8aeb7ecabbd}\label{ari_pi__2_d_c__esp__08_8ino_a8c4da7cbc4b1a3cc91ebb8aeb7ecabbd}} 
float {\bfseries xc}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_abc8f2957d7ee72cfb3e2af9bdfc27018}\label{ari_pi__2_d_c__esp__08_8ino_abc8f2957d7ee72cfb3e2af9bdfc27018}} 
float {\bfseries yc}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a87efb8e08c2adbc437cc67078d6a55fc}\label{ari_pi__2_d_c__esp__08_8ino_a87efb8e08c2adbc437cc67078d6a55fc}} 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a87efb8e08c2adbc437cc67078d6a55fc}{teta\+Compass}}
\begin{DoxyCompactList}\small\item\em vettori magnetici dalla bussola \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_affc72d7637b810bd21ce037f035b6e0a}\label{ari_pi__2_d_c__esp__08_8ino_affc72d7637b810bd21ce037f035b6e0a}} 
float {\bfseries delta\+Compass}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_aab8609ee95cbabd2ffeaf176b9fac768}\label{ari_pi__2_d_c__esp__08_8ino_aab8609ee95cbabd2ffeaf176b9fac768}} 
float {\bfseries teta\+Compass\+\_\+prev}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_afae537763d72e1c7aa5bddabb567ee76}\label{ari_pi__2_d_c__esp__08_8ino_afae537763d72e1c7aa5bddabb567ee76}} 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_afae537763d72e1c7aa5bddabb567ee76}{teta\+Compass\+Read}}
\begin{DoxyCompactList}\small\item\em variabili bussola \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a0a2c5b7e5415d49d86d1c9a388128712}\label{ari_pi__2_d_c__esp__08_8ino_a0a2c5b7e5415d49d86d1c9a388128712}} 
char \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a0a2c5b7e5415d49d86d1c9a388128712}{modo\+Guida}} = 0
\begin{DoxyCompactList}\small\item\em modalita\textquotesingle{} di guida\+: odometro, bussola, misto, fusione ... \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a738a053ee840162d6a9646fe09f00ea8}\label{ari_pi__2_d_c__esp__08_8ino_a738a053ee840162d6a9646fe09f00ea8}} 
char \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a738a053ee840162d6a9646fe09f00ea8}{bussola}}
\begin{DoxyCompactList}\small\item\em presenza bussola \end{DoxyCompactList}\item 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_ab9355e95cf7b931e4ac76a90c7b163c6}{ox}} = 21.\+0
\begin{DoxyCompactList}\small\item\em offset lungo l\textquotesingle{}asse x. viene ricavato a seguito della calibrazione \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a751717b9e3018eb4938a31fba5e636af}\label{ari_pi__2_d_c__esp__08_8ino_a751717b9e3018eb4938a31fba5e636af}} 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a751717b9e3018eb4938a31fba5e636af}{oy}} = 3.\+64
\begin{DoxyCompactList}\small\item\em offset lungo l\textquotesingle{}asse y. viene ricavato a seguito della calibrazione \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a707bc08df1e702c248d1a2225fefc1ce}\label{ari_pi__2_d_c__esp__08_8ino_a707bc08df1e702c248d1a2225fefc1ce}} 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a707bc08df1e702c248d1a2225fefc1ce}{ky}} = 1.\+343376
\begin{DoxyCompactList}\small\item\em guadagno lungo asse y. viene ricavato a seguito della calibrazione \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a20aa2804cc392e162754639d1ec564d4}\label{ari_pi__2_d_c__esp__08_8ino_a20aa2804cc392e162754639d1ec564d4}} 
float {\bfseries VA}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a46393dabfdc8b3c70d5811eadaedeaf4}\label{ari_pi__2_d_c__esp__08_8ino_a46393dabfdc8b3c70d5811eadaedeaf4}} 
float {\bfseries VB}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a095b3da49a4477973982187eae80f87b}\label{ari_pi__2_d_c__esp__08_8ino_a095b3da49a4477973982187eae80f87b}} 
int {\bfseries cnt\+Stop} = 0
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a1ea5d0cb93f22f7d0fdf804bd68c3326}\label{ari_pi__2_d_c__esp__08_8ino_a1ea5d0cb93f22f7d0fdf804bd68c3326}} 
int {\bfseries mode} = \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a3e6a2d7b0da74a50b9fd5b16aace4414}{T\+E\+S\+T\+\_\+\+S\+T\+E\+R\+ZO}}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ae2c1c9186b3f289530624f44f4e698d7}\label{ari_pi__2_d_c__esp__08_8ino_ae2c1c9186b3f289530624f44f4e698d7}} 
char {\bfseries monitor\+Dati} = 0
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a76da74d153b9813dd1e568a77a05707b}\label{ari_pi__2_d_c__esp__08_8ino_a76da74d153b9813dd1e568a77a05707b}} 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a76da74d153b9813dd1e568a77a05707b}{i\+\_\+part}} = 0
\begin{DoxyCompactList}\small\item\em parte integrale regolatore guida \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_aac1a5446ad100de2f39ea367994f0766}\label{ari_pi__2_d_c__esp__08_8ino_aac1a5446ad100de2f39ea367994f0766}} 
float {\bfseries delta\+\_\+teta}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a7fa6816c80e0264d9018d4e59f5a79cd}\label{ari_pi__2_d_c__esp__08_8ino_a7fa6816c80e0264d9018d4e59f5a79cd}} 
float {\bfseries deltaS}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_adb09a635e5dce1cb72809b635590795f}\label{ari_pi__2_d_c__esp__08_8ino_adb09a635e5dce1cb72809b635590795f}} 
long {\bfseries spd\+Dx\+Cnt}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ad968c532014efdd0469f8476af86bbbc}\label{ari_pi__2_d_c__esp__08_8ino_ad968c532014efdd0469f8476af86bbbc}} 
long \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_ad968c532014efdd0469f8476af86bbbc}{spd\+Sx\+Cnt}}
\begin{DoxyCompactList}\small\item\em velocità encoder, impulsi per tempo di campionamento \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a9e213b245d9e31efaa646bd5a7a607ef}\label{ari_pi__2_d_c__esp__08_8ino_a9e213b245d9e31efaa646bd5a7a607ef}} 
int \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a9e213b245d9e31efaa646bd5a7a607ef}{lidar\+Distance}}
\begin{DoxyCompactList}\small\item\em distance measured by lidar \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a432a4bb4f42b6564f87ba1463b70d668}\label{ari_pi__2_d_c__esp__08_8ino_a432a4bb4f42b6564f87ba1463b70d668}} 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a432a4bb4f42b6564f87ba1463b70d668}{delta\+Errore}}
\begin{DoxyCompactList}\small\item\em variabili parte derivativa \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a43bf1698c167f19ec1563cb37355ca7a}\label{ari_pi__2_d_c__esp__08_8ino_a43bf1698c167f19ec1563cb37355ca7a}} 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a43bf1698c167f19ec1563cb37355ca7a}{errore\+K\+\_\+1}}
\begin{DoxyCompactList}\small\item\em variabili parte derivativa \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_abed78639ba3e8d1c1fabb1c684c02409}\label{ari_pi__2_d_c__esp__08_8ino_abed78639ba3e8d1c1fabb1c684c02409}} 
float \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_abed78639ba3e8d1c1fabb1c684c02409}{Der\+Active}}
\begin{DoxyCompactList}\small\item\em variabili parte derivativa \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a6cf81e85cd1dfe1a8f1fffbb474a3aea}\label{ari_pi__2_d_c__esp__08_8ino_a6cf81e85cd1dfe1a8f1fffbb474a3aea}} 
char \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a6cf81e85cd1dfe1a8f1fffbb474a3aea}{occluso\+Davanti}}
\begin{DoxyCompactList}\small\item\em sensore IR anteriore, L\+OW in presenza di ostacolo \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a1265c7245a99fb5e33ccbcf68e058548}\label{ari_pi__2_d_c__esp__08_8ino_a1265c7245a99fb5e33ccbcf68e058548}} 
char \mbox{\hyperlink{ari_pi__2_d_c__esp__08_8ino_a1265c7245a99fb5e33ccbcf68e058548}{enable\+Front\+Sensor}} = 0
\begin{DoxyCompactList}\small\item\em sensore IR anteriore, High abilitato \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a22cb446e5271d5d2c4b2e23792fb1966}\label{ari_pi__2_d_c__esp__08_8ino_a22cb446e5271d5d2c4b2e23792fb1966}} 
unsigned long {\bfseries last\+Time}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a952f8b93b7670156479bc642b5af6ab8}\label{ari_pi__2_d_c__esp__08_8ino_a952f8b93b7670156479bc642b5af6ab8}} 
unsigned long {\bfseries last\+Time\+Fast}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a458b4f86617930d87d3a7540cd482f64}\label{ari_pi__2_d_c__esp__08_8ino_a458b4f86617930d87d3a7540cd482f64}} 
unsigned long {\bfseries time\+Lidar}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ab50fa34f1f6d47cde8715ac543a3b0dd}\label{ari_pi__2_d_c__esp__08_8ino_ab50fa34f1f6d47cde8715ac543a3b0dd}} 
float {\bfseries teta\+\_\+}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ae431043be26faf1019f48badf3fbfc45}\label{ari_pi__2_d_c__esp__08_8ino_ae431043be26faf1019f48badf3fbfc45}} 
float {\bfseries actual\+Teta\+Ref}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ad2b58fa9c2d105a6d47c2c3b778557c1}\label{ari_pi__2_d_c__esp__08_8ino_ad2b58fa9c2d105a6d47c2c3b778557c1}} 
char {\bfseries S\+M\+\_\+\+R5} = 0
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a91db8b0a01ba006126af6bb35384e18f}\label{ari_pi__2_d_c__esp__08_8ino_a91db8b0a01ba006126af6bb35384e18f}} 
unsigned long {\bfseries inizio\+Stabilita}
\item 
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a40ecda65c4ebce49fa139666f210bef0}\label{ari_pi__2_d_c__esp__08_8ino_a40ecda65c4ebce49fa139666f210bef0}} 
sensors\+\_\+event\+\_\+t {\bfseries event}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a8865513d32ebc241dbe80e5bf49ff775}\label{ari_pi__2_d_c__esp__08_8ino_a8865513d32ebc241dbe80e5bf49ff775}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!comandi@{comandi}}
\index{comandi@{comandi}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{comandi()}{comandi()}}
{\footnotesize\ttfamily void comandi (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



comandi\+: i comandi assegnano valori o eseguono funzioni. iniziano con un 3 e hanno la lettera maiuscola, sono seguiti da uno o più numeri. non ci sono spazi di separazione. i numeri, se non diversamente indicato, sono floating point, la virgola è data col \textquotesingle{}.\textquotesingle{}, es 3.\+14 


\begin{DoxyParams}{Parameters}
{\em comando} & \begin{DoxyVerb}Axxx: Alfa. assegna Alfa, la direzione del robot. xxx è l'angolo in radianti, es 3.14. La direzione zero è definita all'accensione del robot. E' la direzione in avanti. Coincide con l'asse x.
        Alfa è positivo in senso antiorario.

Bx:     enableFrontSensor. 1 Enable, 0 disable

Cxxx: assegna "raggiorSterzo" in [m]. La variabile è usata nella movimento R2, stabilisce il raggio della circonferenza su cui ruota il robot.

Dxxx: Distance. La distanza che viene percorsa nel prossimo Run espressa in [mm]. La distanza è sempre incrementale. 

Ex: EEprom.  Esegue operazioni su dei parametri di taratura. Vedi procedura DataEEprom. 

    E0 SCRIVI i parametri in E2prom,            
    E1 LEGGI i parametri in E2prom,             
    E2 rispristina in valori di DEFAULT,            
    E3 mostra i parametri CORRENTI,             
    E4 carica i valori di DEFAULT per il modello ARI02,             
    E5 carica i valori di DEFAULT per il modello ARI03, 

Fnxxx: imposta dei parametri del robot. "n" indica quale parametro, "xxx" è il valore. 

    F0xx ED             
    F1xx ED_BASE            
    F2xx BASELINE       mm
    F3xx GIRO_RUOTA     mm  = sviluppo ruota[mm]/(4*ppr)

    N.B. questi valori vanno attivati con un 3E3

Gxxx:   "Guide Mode". definisce il modo di guida nel run "R4". Il teta di feedback, tetaMisura, può provenire dall'odometria, dalla bussola, o altri mix possibili.
        Nel codice sotto teta è l'angolo ricavato dagli encoder.

        Il modo zero si affida alle misure fatte dagli encoder.
        Il modo 1 e 3 ricavano il teta direttamente dalla bussola. Nel modo 3 anche le posizioni x e y 
        sono calcolate dal teta della bussola.
        con il modo 2 è possibile imporre l'angolo corrente come angolo zero. Altrimenti la direzione è
        assoluta come determinata dalla bussola.

        if (modoGuida == 0) tetaMisura = teta;          // ID_001               
        if (modoGuida == 1) tetaMisura = tetaCompass;   // ID_009               
        if (modoGuida == 3) tetaMisura = tetaCompass;   // ID_009               
        if (modoGuida == 2) {                   
            tetaCompass = 0;    // definisco la direzione corrente come zero.                   
            modoGuida   = 1;
            }

        in updatePosition integro posizioni in funzione del modoGuida attivo

        if (modoGuida == 3) {                   
            xpos    +=  deltaC*cos(tetaCompass);                    
            ypos    +=  deltaC*sin(tetaCompass);                    
        }
        else{                   
            xpos    +=  deltaC*cos(teta);                   
            ypos    +=  deltaC*sin(teta);                   
        }

Knxx:   assegna i guadagni
        K0 kpTeta   il guadagno proporzionale kp usato nel modo Run 4
        K1 kiTeta
        K2 kp_guida il guadagno proporzionale kp usato nel modo Run 1 e 3 (sensore di distanza laterale)
        K3 kd_guida il guadagno derivativo    kd usato nel modo Run 1 e 3 (sensore di distanza laterale)

H0:     Homing, assegna lo posizione corrente (x, y, teta) = (0, 0, 0) 

Ixxx;   Integral part. assegna il guadagno della parte integrale kiTeta usato nel modo Run 4.

Lx:     Led. puntatore a Led acceso, x=1, o spento x=0.

Mx:     Monitor. Attiva, 1, o disattiva, 0, l'invio continuo di misure da parte del robot.
        le msiure sono inviate nella routine "updatePosition" ogni 100 ms.
        La stringa ha l'header "mon:"

        if (monitorDati && (counter >=4) ){
        counter = 0;
        risposta  = "mon;";
        risposta += (dDxCnt);
        risposta += (";");
        risposta += (dSxCnt);
        risposta += (";");
        risposta += (deltaC);
        risposta += (";");
        risposta += (teta);
        risposta += (";");
        risposta += (xpos);
        risposta += (";");
        risposta += (ypos);
        risposta += (";");
        risposta += (i_part);// raggiorSterzo
        risposta += (";");

        risposta += event.magnetic.x;
        risposta += ";";
        risposta += event.magnetic.y;
        risposta += ";";
        risposta += event.magnetic.z;
        risposta += ";";
        sendAnswer2(port);
    }

Nnxxx:  assegna i coefficienti di correzione della bussola.
        N0: ox          
        N1: oy          
        N2: ky

Onxx:   
        O0: distRef      [cm]. riferimento per guida a distanza fissa nei modi R1 e R2
        O0: distOstacolo [cm]. distanza minima sotto la quale ARI si arresta

Pxxx:   orienta il servo PAN della testa. xxx è in gradi, 90° guarda in avanti, 0 a sinistra e 180 a destra.
        in alcuni casi, a seconda del servo usato, è bene limitare l'escursione ad esempio tra 10 e 170°.

Rx:     Run. Definisce in che modo effettuare la corsa "Run". Il run è definito con un obbiettivo (target).
        Il raggiungimento del target termina il run.

        x=4: R4. Il robot si muove sino a percorrere la distanza impostata con "D" nella direzione alfa impostata con "A".
        x=5: R5. Il robot si muove sino a orientarsi nella direzione alfa impostata con "A". La rotazione fa perno su una ruota che rimane ferma.
        x=6: R6. Il robot si muove sino a orientarsi nella direzione alfa impostata con "A". La rotazione avviene con perno al centro del robot con ruote controrotanti.
        x=2: R2. Il robot effettua un percorso circolare con raggio pari al parametro "C". Il raggiorSterzo può anche essere
                 imposto direttamente con il comando "S". In questo caso sarà lo scorrimento tra le ruote dx e sx.

        R1 e 2. i modi 1 e 3 fanno viaggiare il robot a una distanza fissa dalla parete laterale. la misura è fatta orinetando il LIDAR.
                 i due modi sono in test.

        x=99: provoca l'arresto del movimento

        Il movimento si arresta quando il lidar vede un ostacolo troppo vicino.

        if (lidardist<50 && (statoRun != 5) &&(statoRun != 6) &&(statoRun != 0))
            {
                statoRun        = 99;   // senza rampa                  
                motorSpeed      = 0;    // annullo rampa                    
                motorSpeedRef   = 0;                    
                risposta        = "ostacolo";                   
                sendAnswer2(port);                  
            }

Sxxx:   Scorrimento. Imposta direttamente la varibile "raggiDiSterzo". è un numero tra -1 e 1. 
        Zero significa scorrimento nullo, cioè le due ruote hanno la stessa velocità comandata.
        vedi procedura "differenziale"

        ponendo s = raggiorSterzo abbiamo che le velocita' alle ruote valgono:

            VA = motorSpeed*(1-s)           
            VB = motorSpeed*(1+s)       

Txxx:   orienta il servo TILT della testa. xxx è in gradi, 90° guarda in avanti, 0 a sinistra e 180 a destra.
        in alcuni casi, a seconda del servo usato, è bene limitare l'escursione ad esempio tra 10 e 170°.

Vxxx:   Velocità. Definisce la velocità del robot. é il valore assegnato al PWM.    

Zxxx:   definisce MAX_S. è il limite dello scorrimento (positivo e negativo) applicabile dal controllo.\end{DoxyVerb}
 \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ada2502f03f6e1fe62fef80b03f317b98}\label{ari_pi__2_d_c__esp__08_8ino_ada2502f03f6e1fe62fef80b03f317b98}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!compass@{compass}}
\index{compass@{compass}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{compass()}{compass()}}
{\footnotesize\ttfamily void compass (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Gets the most recent sensor values and transform in angle. 

This function reads only x and y magnetometer values. The coefficients for correction are applied.

the output is teta\+Compass which is a global variable.

ox\+: offet on x axis

oy\+: offset on y axis

ky\+: gain on y axis


\begin{DoxyParams}{Parameters}
{\em none} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
none. The output valie is on teta\+Compass global variable 
\end{DoxyReturn}
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a24f4d37ce4673eadaa4043cf6ecaff27}\label{ari_pi__2_d_c__esp__08_8ino_a24f4d37ce4673eadaa4043cf6ecaff27}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!Data\+E\+Eprom@{Data\+E\+Eprom}}
\index{Data\+E\+Eprom@{Data\+E\+Eprom}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{Data\+E\+Eprom()}{DataEEprom()}}
{\footnotesize\ttfamily void Data\+E\+Eprom (\begin{DoxyParamCaption}\item[{char}]{comando }\end{DoxyParamCaption})}



gestisce dei valori sulle E2prom. I vengono letti e scritti nello stesso ordine. La procedura gestisce anche il valore di default. letti i valori si procede ad aggiornare i parametri dipendenti dai valori assegnati. Questa procedura viene chiamata al termine dell\textquotesingle{} start\+Up con comando L\+E\+G\+GI. Vengono quindi attivati i parametri salvati in E\+Eprom. 


\begin{DoxyParams}{Parameters}
{\em comando} & \begin{DoxyVerb}i comandi sono:

SCRIVI  0

LEGGI   1

DEFAULT 2

ATTIVA  3 (attiva e ricalcola i valori GIRO_RUOTA DX, SX etc

temporaneamente i valori 4 e 5 caricano dei valori di default calibrati su due macchine. 4 ARI_02, 5 ARI_03\end{DoxyVerb}
 \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_af117273d2066fa1917036ae9a9742ae7}\label{ari_pi__2_d_c__esp__08_8ino_af117273d2066fa1917036ae9a9742ae7}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!differenziale@{differenziale}}
\index{differenziale@{differenziale}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{differenziale()}{differenziale()}}
{\footnotesize\ttfamily void differenziale (\begin{DoxyParamCaption}\item[{float}]{motor\+Speed }\end{DoxyParamCaption})}



sterzo con differenziale. Per curvare la velocità relativa delle due ruote viene modificata. Con le velocità uguali proseguo diritto, con una maggiore dell\textquotesingle{}altra curvo. 

raggior\+Sterzo (variabile globale) indica lo scorrimento che applichiamo alle ruote. E\textquotesingle{} un numero tra 0 e 2.

ponendo s = raggior\+Sterzo abbiamo che le velocita\textquotesingle{} alle ruote valgono\+:

VA = motor\+Speed$\ast$(1-\/s)

VB = motor\+Speed$\ast$(1+s)

In funzione di Stato\+Run si hanno diversi modi operativi

Stato\+Run .. \+: differenziale in funzione di raggior\+Sterzo

Stato\+Run == 5\+: curva con una ruota ferma

Stato\+Run == 6\+: curva con ruote controrotanti


\begin{DoxyParams}{Parameters}
{\em motor\+Speed.} & Il valore a cui limitare la velocita\textquotesingle{} massima applicata ai motori. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a64ea2b252b5ab59be204f70e2206ce1c}\label{ari_pi__2_d_c__esp__08_8ino_a64ea2b252b5ab59be204f70e2206ce1c}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!get\+Cmd2@{get\+Cmd2}}
\index{get\+Cmd2@{get\+Cmd2}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{get\+Cmd2()}{getCmd2()}}
{\footnotesize\ttfamily void get\+Cmd2 (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



quando arriva una stringa da E\+SP la processa. Il protocollo usato è in A\+S\+C\+II permette di inviare comandi o richieste. ~\newline
 Il primo carattere indica se richiesta (1) o comando (3). 

I caratteri successivi vengono passati alle routine dedicate che eseguono il comando e preparano la stringa \char`\"{}risposta\char`\"{}.

questa viene ritornata dalla funzione send\+Answer2 \mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a23abf4b5bc87f963b0270c015e379872}\label{ari_pi__2_d_c__esp__08_8ino_a23abf4b5bc87f963b0270c015e379872}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!lidar@{lidar}}
\index{lidar@{lidar}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{lidar()}{lidar()}}
{\footnotesize\ttfamily String lidar (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



libreria lettura lidar 

\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a0f6c65484953fd460fd89ee3a1a3825e}\label{ari_pi__2_d_c__esp__08_8ino_a0f6c65484953fd460fd89ee3a1a3825e}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!lidar\+Misura\+Amb@{lidar\+Misura\+Amb}}
\index{lidar\+Misura\+Amb@{lidar\+Misura\+Amb}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{lidar\+Misura\+Amb()}{lidarMisuraAmb()}}
{\footnotesize\ttfamily String lidar\+Misura\+Amb (\begin{DoxyParamCaption}\item[{int}]{numero\+Misure,  }\item[{int}]{ang }\end{DoxyParamCaption})}



legge il lidar e prepara la stringa di risposta. 

inizializza la stringa di risposta come \char`\"{}echo-\/\char`\"{}+\+String(ang)+\char`\"{}-\/\char`\"{};

effettua dapprima 10 letture a vuoto,

appende \char`\"{}numero\+Misure\char`\"{} misure alla risposta ognuna separata da \char`\"{}-\/\char`\"{}


\begin{DoxyParams}{Parameters}
{\em numero\+Misure} & su cui viene \\
\hline
{\em ang} & \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_afe461d27b9c48d5921c00d521181f12f}\label{ari_pi__2_d_c__esp__08_8ino_afe461d27b9c48d5921c00d521181f12f}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!loop@{loop}}
\index{loop@{loop}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{loop()}{loop()}}
{\footnotesize\ttfamily void loop (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

gestione comunicazione con E\+SP

gestione comunicazione con E\+SP

assegna angoli a pan e tilt

funzionamento corrente con anelli di controllo attivi

test e azione ostacoli frontali

stato\+Run

il movimento è gestito da una macchina a stati. Lo stato iniziale è fermo.

0\+: fermo 1\+: controllo sterzo da sensore dx e distanza automatico (non attivo) 1\+: controllo sterzo da sensore sx e distanza automatico (non attivo) 2\+: controllo distanza, sterzo da parametro 4\+: controllo distanza, sterzo da parametro da teta\+Ref vs teta odometria 5\+: rotazione sul posto con una ruota ferma 6\+: rotazione sul posto con ruote controrotanti

99\+: comando arresto

gestione raggiungimento angolo target in questo caso il robot deve ruotare per orientarsi con l\textquotesingle{}angolo dato. Questo vale per i modi 5 e 6.

All\textquotesingle{}approsimarsi della destinazione la velocità viene diminuita per raggiungere il target senza superarlo. ~\newline
~\newline
~\newline
~\newline


gestione raggiungimento distanza target in questo caso il robot deve arrivare alla distanza impostata. Questo vale per i modi (1, 3, 2, 4). Sono esclusi i 5 e 6 che ruotano il robot e sono gestiti nei modi 5 e 6 da una propria macchina a stati.

All\textquotesingle{}approsimarsi della destinazione la velocità viene diminuita per raggiungere il target senza superarlo. ~\newline
~\newline
~\newline


questa parte genera le rampe sulla tensione del motore. Sia in accelerazione che decelerazione. Viene fatta girare con un tempo piu\textquotesingle{} veloce per poter usare gradini di riferimento più piccoli. All\textquotesingle{}arrivo a velocità zero la macchina a stati del movimento viene messa nello stato iniziale.

modo di test. viene usato durante il debug dell\textquotesingle{}hw. viene configurato alla bisogna. I comandi arrivano diretti dalla seriale e codificati comenecessario.\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a6af06b46b74b5a44e1adc270e1e07e6b}\label{ari_pi__2_d_c__esp__08_8ino_a6af06b46b74b5a44e1adc270e1e07e6b}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!odometro\+Dx\+Misura\+HW@{odometro\+Dx\+Misura\+HW}}
\index{odometro\+Dx\+Misura\+HW@{odometro\+Dx\+Misura\+HW}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{odometro\+Dx\+Misura\+H\+W()}{odometroDxMisuraHW()}}
{\footnotesize\ttfamily void odometro\+Dx\+Misura\+HW (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



odometri 

la misura della posizione viene fatta leggendo gli impulsi prodotti dagli encoder rotativi montati sull\textquotesingle{}albero delle ruote. Gli encoder sono dischi con delle fessure regolari. Queste interrompono a tartti il fascio luminoso sul sensore optoelettronico. Ogni transizione genera un interrupt su Arduino. Contando il numero degli impulsi letti si misura lo spazio percorso. La direzione dipende dalla tensione applicata al motore. Gli impulsi vengono sommati in un caso e sottratti nell\textquotesingle{}altro.

Il flag Vx\+\_\+zero indica queando il motore è fermo. In questo caso si evitano i conteggi per evitarne di falsi. Se gli impulsi giugono troppo velocemente vengono considerati errori.

La routine incremmenta contatori di interi per essere veloce. \mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ae29b9282fc7ede860a2bb8984ad0560c}\label{ari_pi__2_d_c__esp__08_8ino_ae29b9282fc7ede860a2bb8984ad0560c}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!r\+Seriale@{r\+Seriale}}
\index{r\+Seriale@{r\+Seriale}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{r\+Seriale()}{rSeriale()}}
{\footnotesize\ttfamily void r\+Seriale (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



riceve i caratteri dalla seriale dell\textquotesingle{}E\+SP. Il char \textquotesingle{}!\textquotesingle{} è l\textquotesingle{}inizio stringa, il \textquotesingle{}?\textquotesingle{} è il terminatore della stringa. il terminatore della stringa è ? 

All\textquotesingle{}arrivo dello start la stringa pulita e inizia l\textquotesingle{}accumolo dei caratteri

All\textquotesingle{}arrivo del terminatore la stringa viene resa disponibile in \char`\"{}input\+String\char`\"{}

! {\itshape flush}

? {\itshape terminatore}

N.\+B. il codice su esp oltre a dispacciare i pacchetti giunti dal Wi\+Fi verso Arduino effettuata anche un filtraggio e una generazione di richieste. filtraggio\+: I pacchetti che iniziano !$>$ sono destinati all\textquotesingle{}esp e sono quindi trattati sull\textquotesingle{}esp stesso. generazione di richieste\+: a tempo l\textquotesingle{}esp richiede a Arduino delle informazioni che poi invia al client.

per dettagli su questa parte vedi codice esp.. \mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a6f20cd3646bc1f8af9a4f9d5e45f5c90}\label{ari_pi__2_d_c__esp__08_8ino_a6f20cd3646bc1f8af9a4f9d5e45f5c90}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!test\+Ostacoli@{test\+Ostacoli}}
\index{test\+Ostacoli@{test\+Ostacoli}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{test\+Ostacoli()}{testOstacoli()}}
{\footnotesize\ttfamily void test\+Ostacoli (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



riporta al controller la distanza letta dal lidar, la risposta ha formato \char`\"{}mis;\char`\"{} + distanza in cm\char`\"{}.
aggiorna anche la il valore \char`\"{}lidardist" ogni 250 ms. 



\subsection{Variable Documentation}
\mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a9c5bc38bd76775bbcb1e430646060ca5}\label{ari_pi__2_d_c__esp__08_8ino_a9c5bc38bd76775bbcb1e430646060ca5}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!B\+A\+S\+E\+L\+I\+NE@{B\+A\+S\+E\+L\+I\+NE}}
\index{B\+A\+S\+E\+L\+I\+NE@{B\+A\+S\+E\+L\+I\+NE}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{B\+A\+S\+E\+L\+I\+NE}{BASELINE}}
{\footnotesize\ttfamily float B\+A\+S\+E\+L\+I\+NE = 130.\+0}

larghezza carreggiata in \mbox{[}mm\mbox{]}. descrizione nella parte cinematica \mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a46145722dc21eed1a702b867ced59e49}\label{ari_pi__2_d_c__esp__08_8ino_a46145722dc21eed1a702b867ced59e49}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!ED@{ED}}
\index{ED@{ED}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{ED}{ED}}
{\footnotesize\ttfamily float ED = 1.\+0}

definiscono la meccanica del robot. descrizione nella parte cinematica \mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_aab9585a72373b934a8e78ac806c57f50}\label{ari_pi__2_d_c__esp__08_8ino_aab9585a72373b934a8e78ac806c57f50}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!E\+D\+\_\+\+B\+A\+SE@{E\+D\+\_\+\+B\+A\+SE}}
\index{E\+D\+\_\+\+B\+A\+SE@{E\+D\+\_\+\+B\+A\+SE}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{E\+D\+\_\+\+B\+A\+SE}{ED\_BASE}}
{\footnotesize\ttfamily float E\+D\+\_\+\+B\+A\+SE = 1.\+0}

definiscono la meccanica del robot. descrizione nella parte cinematica \mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ac57aebfcef0c4d31360b170366395c4a}\label{ari_pi__2_d_c__esp__08_8ino_ac57aebfcef0c4d31360b170366395c4a}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!G\+I\+R\+O\+\_\+\+R\+U\+O\+TA@{G\+I\+R\+O\+\_\+\+R\+U\+O\+TA}}
\index{G\+I\+R\+O\+\_\+\+R\+U\+O\+TA@{G\+I\+R\+O\+\_\+\+R\+U\+O\+TA}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{G\+I\+R\+O\+\_\+\+R\+U\+O\+TA}{GIRO\_RUOTA}}
{\footnotesize\ttfamily float G\+I\+R\+O\+\_\+\+R\+U\+O\+TA = 1.\+0}

(G\+I\+R\+O\+\_\+\+R\+U\+O\+T\+A\+\_\+\+SX + G\+I\+R\+O\+\_\+\+R\+U\+O\+T\+A\+\_\+\+DX)/2. descrizione nella parte cinematica \mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a87caded4c49d6deea703487e7f11d9e3}\label{ari_pi__2_d_c__esp__08_8ino_a87caded4c49d6deea703487e7f11d9e3}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!G\+I\+R\+O\+\_\+\+R\+U\+O\+T\+A\+\_\+\+DX@{G\+I\+R\+O\+\_\+\+R\+U\+O\+T\+A\+\_\+\+DX}}
\index{G\+I\+R\+O\+\_\+\+R\+U\+O\+T\+A\+\_\+\+DX@{G\+I\+R\+O\+\_\+\+R\+U\+O\+T\+A\+\_\+\+DX}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{G\+I\+R\+O\+\_\+\+R\+U\+O\+T\+A\+\_\+\+DX}{GIRO\_RUOTA\_DX}}
{\footnotesize\ttfamily float G\+I\+R\+O\+\_\+\+R\+U\+O\+T\+A\+\_\+\+DX = 1.\+0}

\mbox{[}mm per impulso$\ast$0.5\mbox{]} sviluppo ruota\mbox{[}mm\mbox{]}/(2$\ast$ppr) (pulses per revolution)\mbox{]}. descrizione nella parte cinematica \mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_aeee767366b9e5e9bb8022b27fcbb7e68}\label{ari_pi__2_d_c__esp__08_8ino_aeee767366b9e5e9bb8022b27fcbb7e68}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!G\+I\+R\+O\+\_\+\+R\+U\+O\+T\+A\+\_\+\+SX@{G\+I\+R\+O\+\_\+\+R\+U\+O\+T\+A\+\_\+\+SX}}
\index{G\+I\+R\+O\+\_\+\+R\+U\+O\+T\+A\+\_\+\+SX@{G\+I\+R\+O\+\_\+\+R\+U\+O\+T\+A\+\_\+\+SX}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{G\+I\+R\+O\+\_\+\+R\+U\+O\+T\+A\+\_\+\+SX}{GIRO\_RUOTA\_SX}}
{\footnotesize\ttfamily float G\+I\+R\+O\+\_\+\+R\+U\+O\+T\+A\+\_\+\+SX = 1.\+0}

\mbox{[}mm per impulso$\ast$0.5\mbox{]} sviluppo ruota\mbox{[}mm\mbox{]}/(2$\ast$ppr) (pulses per revolution)\mbox{]}. descrizione nella parte cinematica \mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a023cb7e635b51ac94b3e22f2b6ac8f9c}\label{ari_pi__2_d_c__esp__08_8ino_a023cb7e635b51ac94b3e22f2b6ac8f9c}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!L\+A\+G\+H\+E\+Z\+Z\+A\+\_\+\+A\+\_\+\+M\+E\+Z\+ZI@{L\+A\+G\+H\+E\+Z\+Z\+A\+\_\+\+A\+\_\+\+M\+E\+Z\+ZI}}
\index{L\+A\+G\+H\+E\+Z\+Z\+A\+\_\+\+A\+\_\+\+M\+E\+Z\+ZI@{L\+A\+G\+H\+E\+Z\+Z\+A\+\_\+\+A\+\_\+\+M\+E\+Z\+ZI}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{L\+A\+G\+H\+E\+Z\+Z\+A\+\_\+\+A\+\_\+\+M\+E\+Z\+ZI}{LAGHEZZA\_A\_MEZZI}}
{\footnotesize\ttfamily float L\+A\+G\+H\+E\+Z\+Z\+A\+\_\+\+A\+\_\+\+M\+E\+Z\+ZI = 0.\+065}

larghezza meta\textquotesingle{} carreggiata in \mbox{[}m\mbox{]}. descrizione nella parte cinematica \mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a6a8d27409d947dce17cce28a56701a5c}\label{ari_pi__2_d_c__esp__08_8ino_a6a8d27409d947dce17cce28a56701a5c}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!M\+I\+N\+\_\+\+T\+I\+M\+E\+\_\+\+T\+R\+A\+\_\+\+P\+U\+L\+SE@{M\+I\+N\+\_\+\+T\+I\+M\+E\+\_\+\+T\+R\+A\+\_\+\+P\+U\+L\+SE}}
\index{M\+I\+N\+\_\+\+T\+I\+M\+E\+\_\+\+T\+R\+A\+\_\+\+P\+U\+L\+SE@{M\+I\+N\+\_\+\+T\+I\+M\+E\+\_\+\+T\+R\+A\+\_\+\+P\+U\+L\+SE}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{M\+I\+N\+\_\+\+T\+I\+M\+E\+\_\+\+T\+R\+A\+\_\+\+P\+U\+L\+SE}{MIN\_TIME\_TRA\_PULSE}}
{\footnotesize\ttfamily unsigned long M\+I\+N\+\_\+\+T\+I\+M\+E\+\_\+\+T\+R\+A\+\_\+\+P\+U\+L\+SE = 9}

tempo minimo tra impulsi encoder per evitare errate letture \mbox{[}ms\mbox{]}

aggiorno per encoder da 35 ppr prima erano 20 /$\ast$ ari 1 con encoder da 20 ppr \#define G\+I\+R\+O\+\_\+\+R\+U\+O\+TA 2.\+625 // 20ppr 5.\+25 // mm per impulso$\ast$0.5 = sviluppo ruota\mbox{[}mm\mbox{]}/ppr (pulsi per rivoluzione) \#define G\+I\+R\+O\+\_\+\+R\+U\+O\+T\+A\+\_\+\+DX 2.\+625 // 20ppr 5.\+25 \#define G\+I\+R\+O\+\_\+\+R\+U\+O\+T\+A\+\_\+\+SX 2.\+615 // 20ppr 5.\+25 \#define M\+I\+N\+\_\+\+T\+I\+M\+E\+\_\+\+T\+R\+A\+\_\+\+P\+U\+L\+SE 9 // 20 ppr 18 // tempo minimo tra impulsi encoder per evitare errate letture \mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ab8a00bd06cb46156aa7cb936b4eb8c85}\label{ari_pi__2_d_c__esp__08_8ino_ab8a00bd06cb46156aa7cb936b4eb8c85}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!M\+T\+R\+\_\+\+A\+\_\+\+D\+X\+\_\+\+P1@{M\+T\+R\+\_\+\+A\+\_\+\+D\+X\+\_\+\+P1}}
\index{M\+T\+R\+\_\+\+A\+\_\+\+D\+X\+\_\+\+P1@{M\+T\+R\+\_\+\+A\+\_\+\+D\+X\+\_\+\+P1}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{M\+T\+R\+\_\+\+A\+\_\+\+D\+X\+\_\+\+P1}{MTR\_A\_DX\_P1}}
{\footnotesize\ttfamily const int M\+T\+R\+\_\+\+A\+\_\+\+D\+X\+\_\+\+P1 = 5}

output pin 1 for right motor \mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a1daadb07ea3186bedb91de1bbfb47b58}\label{ari_pi__2_d_c__esp__08_8ino_a1daadb07ea3186bedb91de1bbfb47b58}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!M\+T\+R\+\_\+\+A\+\_\+\+D\+X\+\_\+\+P2@{M\+T\+R\+\_\+\+A\+\_\+\+D\+X\+\_\+\+P2}}
\index{M\+T\+R\+\_\+\+A\+\_\+\+D\+X\+\_\+\+P2@{M\+T\+R\+\_\+\+A\+\_\+\+D\+X\+\_\+\+P2}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{M\+T\+R\+\_\+\+A\+\_\+\+D\+X\+\_\+\+P2}{MTR\_A\_DX\_P2}}
{\footnotesize\ttfamily const int M\+T\+R\+\_\+\+A\+\_\+\+D\+X\+\_\+\+P2 = 6}

output pin 2 for right motor \mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a8b68fd0f29306f0feb3d5f3ac5c5c9b4}\label{ari_pi__2_d_c__esp__08_8ino_a8b68fd0f29306f0feb3d5f3ac5c5c9b4}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!M\+T\+R\+\_\+\+B\+\_\+\+S\+X\+\_\+\+P1@{M\+T\+R\+\_\+\+B\+\_\+\+S\+X\+\_\+\+P1}}
\index{M\+T\+R\+\_\+\+B\+\_\+\+S\+X\+\_\+\+P1@{M\+T\+R\+\_\+\+B\+\_\+\+S\+X\+\_\+\+P1}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{M\+T\+R\+\_\+\+B\+\_\+\+S\+X\+\_\+\+P1}{MTR\_B\_SX\_P1}}
{\footnotesize\ttfamily const int M\+T\+R\+\_\+\+B\+\_\+\+S\+X\+\_\+\+P1 = 9}

output pin 1 for left motor \mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_a77c90f26573c080620f9baca24364ebe}\label{ari_pi__2_d_c__esp__08_8ino_a77c90f26573c080620f9baca24364ebe}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!M\+T\+R\+\_\+\+B\+\_\+\+S\+X\+\_\+\+P2@{M\+T\+R\+\_\+\+B\+\_\+\+S\+X\+\_\+\+P2}}
\index{M\+T\+R\+\_\+\+B\+\_\+\+S\+X\+\_\+\+P2@{M\+T\+R\+\_\+\+B\+\_\+\+S\+X\+\_\+\+P2}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{M\+T\+R\+\_\+\+B\+\_\+\+S\+X\+\_\+\+P2}{MTR\_B\_SX\_P2}}
{\footnotesize\ttfamily const int M\+T\+R\+\_\+\+B\+\_\+\+S\+X\+\_\+\+P2 = 10}

output pin 2 for left motor \mbox{\Hypertarget{ari_pi__2_d_c__esp__08_8ino_ab9355e95cf7b931e4ac76a90c7b163c6}\label{ari_pi__2_d_c__esp__08_8ino_ab9355e95cf7b931e4ac76a90c7b163c6}} 
\index{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}!ox@{ox}}
\index{ox@{ox}!ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino@{ari\+Pi\+\_\+2\+D\+C\+\_\+esp\+\_\+08.\+ino}}
\subsubsection{\texorpdfstring{ox}{ox}}
{\footnotesize\ttfamily float ox = 21.\+0}



offset lungo l\textquotesingle{}asse x. viene ricavato a seguito della calibrazione 

coefficienti calibrazione bussola 